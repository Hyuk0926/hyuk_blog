<header th:fragment="header" class="navbar navbar-expand-lg navbar-light bg-light" style="position: sticky; top: 0; z-index: 1000; width: 100%;">
    <div class="container">
        <a class="navbar-brand" th:href="@{/}">Takahara's Blog</a>
        <nav>
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" th:href="@{/index}">ì§€ì‹ëª¨ìŒ</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/projects}">í”„ë¡œì íŠ¸</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/about}">ì´ë ¥</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/contact}">Contact</a></li>
            </ul>
        </nav>
        <button id="darkModeToggle" title="ë‹¤í¬ëª¨ë“œ í† ê¸€">ğŸŒ™</button>
        <div id="langToggle" style="display:inline-block; margin-left:18px; font-size:1.08rem; font-weight:600;">
          <span id="lang-ko" style="cursor:pointer; color:#007bff;">KO</span> |
          <span id="lang-jp" style="cursor:pointer; color:#888;">JP</span>
        </div>
    </div>
    <script>
        // ë‹¤í¬ëª¨ë“œ ì ìš© í•¨ìˆ˜
        function setDarkMode(enabled) {
            const btn = document.getElementById('darkModeToggle');
            if (enabled) {
                document.body.classList.add('dark-mode');
                localStorage.setItem('darkMode', 'true');
                if (btn) btn.textContent = 'â˜€ï¸';
            } else {
                document.body.classList.remove('dark-mode');
                localStorage.setItem('darkMode', 'false');
                if (btn) btn.textContent = 'ğŸŒ™';
            }
        }
        // í† ê¸€ ë²„íŠ¼ ì´ë²¤íŠ¸
        document.addEventListener('DOMContentLoaded', function() {
            const btn = document.getElementById('darkModeToggle');
            // ì´ˆê¸° ìƒíƒœ
            if (localStorage.getItem('darkMode') === 'true') {
                setDarkMode(true);
            } else {
                setDarkMode(false);
            }
            btn.addEventListener('click', function() {
                const enabled = !document.body.classList.contains('dark-mode');
                setDarkMode(enabled);
            });
        });
        // ì–¸ì–´ í† ê¸€
        function setLang(lang) {
            localStorage.setItem('lang', lang);
            document.documentElement.setAttribute('lang', lang === 'jp' ? 'ja' : 'ko');
            document.getElementById('lang-ko').style.color = lang === 'ko' ? '#007bff' : '#888';
            document.getElementById('lang-jp').style.color = lang === 'jp' ? '#007bff' : '#888';
            // í˜ì´ì§€ ë‚´ í…ìŠ¤íŠ¸ êµì²´(ê°„ë‹¨ ì˜ˆì‹œ, ì‹¤ì œëŠ” ê° í˜ì´ì§€ë³„ë¡œ êµ¬í˜„ í•„ìš”)
            if(window.applyLang) window.applyLang(lang);
        }
        document.addEventListener('DOMContentLoaded', function() {
            // ì–¸ì–´ í† ê¸€ ì´ë²¤íŠ¸
            document.getElementById('lang-ko').onclick = function() { setLang('ko'); };
            document.getElementById('lang-jp').onclick = function() { setLang('jp'); };
            // ì´ˆê¸° ì–¸ì–´
            setLang(localStorage.getItem('lang') || 'ko');
        });
    </script>
</header>
